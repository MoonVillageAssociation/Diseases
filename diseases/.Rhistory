"Abnormality of facial musculature","Abnormality of facial soft tissue",
"Abnormality of head or neck","Abnormality of prenatal development or birth",
"Abnormality of skull size","Abnormality of the forehead","Abnormality of the head",
"Abnormality of the skull base","Aplasia cutis congenita","Aplasia of the fingers",
"Aplasia/Hypoplasia affecting the eye","Aplasia/Hypoplasia affecting the fundus",
"Aplasia/Hypoplasia involving bones of the feet",
"Aplasia/Hypoplasia involving the central nervous system","Aplasia/Hypoplasia of fingers",
"Aplasia/Hypoplasia of the cerebrum","Aplasia/Hypoplasia of the corpus callosum",
"Aplasia/Hypoplasia of the mandible","Aplasia/Hypoplasia of the skin",
"Aplasia/hypoplasia affecting bones of the axial skeleton",
"Aplasia/hypoplasia involving bones of the extremities",
"Aplasia/hypoplasia involving bones of the hand",
"Aplasia/hypoplasia involving bones of the lower limbs",
"Aplasia/hypoplasia involving bones of the upper limbs","Aplasia/hypoplasia involving the skeleton",
"Aplasia/hypoplasia of the extremities","Birth weight","Broad forehead","Budd-Chiari syndrome",
"Cleft palate","Cleft soft palate","Congenital abnormal hair pattern",
"Congenital malformation of the great arteries","Coronal craniosynostosis","Craniosynostosis",
"Decreased head circumference","Developmental cataract","Developmental glaucoma",
"Erythroid hypoplasia","Fetal anomaly","Genetic disorder","Global developmental delay",
"Head tremor","High palate","\"High, narrow palate\"","Hydrops fetalis",
"Hypoplasia of teeth","Hypoplasia of the maxilla","Lambdoidal craniosynostosis","Microcephaly",
"Narrow palate","Neurodevelopmental abnormality","Neurodevelopmental delay",
"Nonimmune hydrops fetalis","Optic nerve hypoplasia","Oral cleft","Pain in head and neck region",
"Proportionate short stature","Pure red cell aplasia","Radial artery aplasia","Renal agenesis",
"Renal hypoplasia/aplasia","Sagittal craniosynostosis","Severe short stature","Short stature",
"Small forehead","Age","Test result","Sign or symptom","Disease","Sign or symptom",
"Population measurement","Self reported educational attainment","Parental longevity",
"Traffic air pollution measurement","Educational attainment","Hypospadias","Narrow mouth",
"Brachycephaly","Microcephaly","Turricephaly","Abnormality of the face",
"Abnormal mandible morphology","Retrognathia","Abnormality of the forehead","Pointed chin",
"Hypertelorism","Triangular face","Abnormality of the maxilla","Broad forehead","Long philtrum",
"Abnormal location of ears","Abnormal earlobe morphology","Low-set ears","Tooth malposition",
"Split hand","Triphalangeal thumb","Slender finger","Broad finger","Small for gestational age",
"Split foot","Metatarsus adductus","Underdeveloped supraorbital ridges","Crumpled ear",
"Duplication of thumb phalanx","Partial duplication of thumb phalanx",
"Partial duplication of the phalanx of hand","Duplication of phalanx of hallux",
"Abnormality of the phalanges of the toes","Midface retrusion","Short digit","Flat face"
)
# Remove excluded rows
df <- df %>%
filter(!description %in% exclude)
# Get top 10 categories by absolute count
hpo_top_categories_abs <- df %>%
count(class, sort = TRUE) %>%
slice_max(n, n = 10) %>%
pull(class)
# Filter to top 10 categories
hpo_filtered_abs <- df %>%
filter(class %in% hpo_top_categories_abs)
# Count (class, ChemicalName)
hpo_stacked_data <- hpo_filtered_abs %>%
count(class, ChemicalName)
# Reorder categories by total count
hpo_category_order_abs <- hpo_stacked_data %>%
group_by(class) %>%
summarise(total = sum(n), .groups = "drop") %>%
arrange(desc(total)) %>%
pull(class)
# Factor with desired order
hpo_stacked_data$class <- factor(
hpo_stacked_data$class,
levels = hpo_category_order_abs
)
# Plot stacked bar chart
hpo_chemical_contributions_stacked_bar <- ggplot(hpo_stacked_data, aes(
x = n,
y = class,
fill = ChemicalName
)) +
geom_bar(stat = "identity") +
labs(
title = "Chemical Contributions in Top 10 HPO Categories",
x = "Number of Occurrences",
y = "class"
) +
scale_x_continuous(expand = c(0, 0)) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12)
) +
guides(fill = guide_legend(title = "Chemical Name"))
print(hpo_chemical_contributions_stacked_bar)
# Save plot
ggsave(
"HPO_analysis/chemical_contributions_stacked_bar.png",
plot = hpo_chemical_contributions_stacked_bar,
width = 10, height = 6, dpi = 300
)
# Top 10 categories by absolute count (reuse logic for consistency)
hpo_top_categories_rel <- df %>%
count(class, name = "total") %>%
slice_max(total, n = 10) %>%
pull(class)
# Filter to those categories
hpo_filtered_rel <- df %>%
filter(class %in% hpo_top_categories_rel)
# Count (class, ChemicalName) pairs
hpo_contributions_rel <- hpo_filtered_rel %>%
count(class, ChemicalName, name = "n")
# Normalize within each category
hpo_normalized_rel <- hpo_contributions_rel %>%
group_by(class) %>%
mutate(share = n / sum(n)) %>%
ungroup()
# Order categories by total occurrences (same order as absolute totals)
hpo_category_order_rel <- hpo_contributions_rel %>%
group_by(class) %>%
summarise(total = sum(n), .groups = "drop") %>%
arrange(desc(total)) %>%
pull(class)
hpo_normalized_rel$class <- factor(
hpo_normalized_rel$class,
levels = hpo_category_order_rel
)
# Plot normalized stacked bar (vertical)
hpo_rel_plot <- ggplot(hpo_normalized_rel, aes(x = class, y = share, fill = ChemicalName)) +
geom_col(width = 0.7) +
labs(
title = "Relative Chemical Contributions in Top 10 HPO Categories",
x = "class",
y = "Relative Share"
) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_text(size = 12)
) +
guides(fill = guide_legend(title = "Chemical Name"))
print(hpo_rel_plot)
# Save
ggsave("HPO_analysis/normalized_chemical_contributions.png",
plot = hpo_rel_plot, width = 12, height = 6, dpi = 300)
# Define HPO groups
blood_chemistry_biomarkers <- c(
"Protein measurement","Abnormal circulating metabolite concentration","Blood protein measurement",
"Hematological measurement","Lipid measurement","Lipid or lipoprotein measurement",
"Triglyceride measurement","Abnormal circulating lipid concentration","Abnormal enzyme/coenzyme activity",
"Lipoprotein measurement","Abnormal LDL cholesterol concentration",
"Abnormal circulating carboxylic acid concentration","Abnormal circulating cholesterol concentration",
"Abnormal circulating nitrogen compound concentration","Apolipoprotein A 1 measurement",
"Decreased circulating GABA concentration","Elevated sweat chloride","Liver enzyme measurement",
"Serum alanine aminotransferase measurement","Serum urea measurement",
"Abnormal blood cation concentration","Abnormal blood ion concentration",
"Abnormal blood potassium concentration","Abnormal circulating albumin concentration",
"Abnormal erythrocyte sedimentation rate","Abnormal glucose homeostasis","Cytokine measurement",
"Glucose measurement","Hypercholesterolemia","Hyperlipoproteinemia",
"Increased LDL cholesterol concentration","Low density lipoprotein cholesterol measurement",
"Metabolite measurement","Serum gamma-glutamyl transferase measurement","Transferrin saturation measurement",
"Abnormal blood monovalent inorganic cation concentration","Abnormal circulating bilirubin concentration",
"Abnormal circulating creatine kinase concentration","Abnormal circulating dicarboxylic acid concentration",
"Abnormal circulating ferritin concentration","Abnormal circulating non-proteinogenic amino acid concentration",
"Amino acid measurement","Antibody measurement","Apolipoprotein B measurement",
"Aspartate aminotransferase measurement",
"Aspartate aminotransferase to alanine aminotransferase ratio",
"Decreased plasma total carnitine","Diabetes mellitus biomarker","Elevated alpha-fetoprotein",
"Elevated circulating creatine kinase concentration","Endothelial growth factor measurement",
"Glucose intolerance","High density lipoprotein cholesterol measurement","Hyperammonemia",
"Hyperlipidemia","Hypoalbuminemia","Iron biomarker measurement",
"Leucine carboxyl methyltransferase 1 measurement","Liver disease biomarker",
"Serum albumin measurement","Serum iron measurement","Sphingolipid measurement",
"Total cholesterol measurement","Urate measurement","Increased circulating ferritin concentration",
"Elevated erythrocyte sedimentation rate"
)
erythrocytes_rbc <- c(
"Anemia","Abnormal erythrocyte morphology","Hemoglobin measurement","Anemia of inadequate production",
"Complete blood cell count","Reticulocyte count","Reticulocyte measurement","Macrocytic anemia",
"Mean corpuscular volume","Erythrocyte count","Erythrocyte indices","Erythrocyte measurement",
"Hypochromic anemia","Persistence of hemoglobin F","Red blood cell distribution width",
"Macrocytic dyserythropoietic anemia","Poikilocytosis","Reticulocytopenia","Methemoglobinemia",
"Polycythemia","Reticulocytosis","Abnormal number of erythroid precursors",
"Elevated red cell adenosine deaminase level","Extramedullary hematopoiesis","Heinz bodies",
"Abnormal hemoglobin","Normochromic anemia","Increased mean corpuscular volume",
"Mean corpuscular hemoglobin","Mean reticulocyte volume","Abnormal mean corpuscular volume",
"Red blood cell density measurement"
)
blood_total_count <- df %>%
filter(class == "Blood") %>%
nrow()
blood_in_all_pct <- blood_total_count / nrow(df) * 100
print(sprintf(
"%.1f%% of all HPO occurrences are classified as Blood (%d out of %d).",
blood_in_all_pct, blood_total_count, nrow(df)
))
biomarkers_count <- df %>%
filter(class == "Blood") %>%
filter(grepl(paste(blood_chemistry_biomarkers, collapse = "|"),
description, ignore.case = TRUE)) %>%
nrow()
biomarkers_pct <- biomarkers_count / blood_total_count * 100
print(sprintf(
"%.1f%% of Blood HPO occurrences are biomarkers (%d out of %d).",
biomarkers_pct, biomarkers_count, blood_total_count
))
rbc_count <- df %>%
filter(class == "Blood") %>%
filter(grepl(paste(erythrocytes_rbc, collapse = "|"),
description, ignore.case = TRUE)) %>%
nrow()
rbc_pct <- rbc_count / blood_total_count * 100
print(sprintf(
"%.1f%% of Blood HPO occurrences are erythrocyte/RBC-related (%d out of %d).",
rbc_pct, rbc_count, blood_total_count
))
musculoskeletal_total_count <- df %>%
filter(class == "Musculoskeletal") %>%
nrow()
musculoskeletal_in_all_pct <- musculoskeletal_total_count / nrow(df) * 100
print(sprintf(
"%.1f%% of all HPO occurrences are classified as Musculoskeletal (%d out of %d).",
musculoskeletal_in_all_pct, musculoskeletal_total_count, nrow(df)
))
cardiovascular_total_count <- df %>%
filter(class == "Cardiovascular") %>%
nrow()
cardiovascular_in_all_pct <- cardiovascular_total_count / nrow(df) * 100
print(sprintf(
"%.1f%% of all HPO occurrences are classified as Cardiovascular (%d out of %d).",
cardiovascular_in_all_pct, blood_total_count, nrow(df)
))
musculoskeletal_total <- df %>%
filter(class == "Musculoskeletal")
View(musculoskeletal_total)
musculoskeletal_total <- df %>%
filter(class == "Musculoskeletal") %>%
summarise(count = n())
View(musculoskeletal_total)
class_counts <- df %>%
group_by(class) %>%
summarise(count = n()) %>%
arrange(desc(count))
View(class_counts)
musculoskeletal_class_counts <- df %>%
filter(class == "Musculoskeletal") %>%
group_by(class) %>%
summarise(count = n()) %>%
arrange(desc(count))
View(musculoskeletal_total)
View(musculoskeletal_class_counts)
musculoskeletal_counts <- df %>%
filter(class == "Musculoskeletal") %>%
group_by(classification) %>%      # change this to your column of interest
summarise(count = n()) %>%
arrange(desc(count))
musculoskeletal_counts <- df %>%
filter(class == "Musculoskeletal") %>%
group_by(class) %>%      # change this to your column of interest
summarise(count = n()) %>%
arrange(desc(count))
View(musculoskeletal_class_counts)
View(musculoskeletal_total)
View(musculoskeletal_counts)
musculoskeletal_counts <- df %>%
filter(class == "Musculoskeletal") %>%
group_by(description) %>%      # change this to your column of interest
summarise(count = n()) %>%
arrange(desc(count))
View(musculoskeletal_counts)
# Load libraries
library(dplyr)
library(ggplot2)
library(readr)
library(stringr)
library(tidyr)
library(scales)
library(tibble)
library(purrr)
# Read data
df <- read_csv("StringDB_results/ALL_HPO.csv") %>%
select(where(~ !all(is.na(.))))
# Load the updated classification table
categories <- read_csv("HPO_terms_classified.csv") %>%
select(-term)
# Merge based on 'description'
df <- df %>%
left_join(categories, by = "description")
# Exclusions (as provided)
exclude <- c(
"Abnormal facial shape","Abnormal facial skeleton morphology","Abnormal fetal morphology",
"Abnormal palate morphology","Abnormal skull morphology","Abnormal soft palate morphology",
"Abnormality of facial musculature","Abnormality of facial soft tissue",
"Abnormality of head or neck","Abnormality of prenatal development or birth",
"Abnormality of skull size","Abnormality of the forehead","Abnormality of the head",
"Abnormality of the skull base","Aplasia cutis congenita","Aplasia of the fingers",
"Aplasia/Hypoplasia affecting the eye","Aplasia/Hypoplasia affecting the fundus",
"Aplasia/Hypoplasia involving bones of the feet",
"Aplasia/Hypoplasia involving the central nervous system","Aplasia/Hypoplasia of fingers",
"Aplasia/Hypoplasia of the cerebrum","Aplasia/Hypoplasia of the corpus callosum",
"Aplasia/Hypoplasia of the mandible","Aplasia/Hypoplasia of the skin",
"Aplasia/hypoplasia affecting bones of the axial skeleton",
"Aplasia/hypoplasia involving bones of the extremities",
"Aplasia/hypoplasia involving bones of the hand",
"Aplasia/hypoplasia involving bones of the lower limbs",
"Aplasia/hypoplasia involving bones of the upper limbs","Aplasia/hypoplasia involving the skeleton",
"Aplasia/hypoplasia of the extremities","Birth weight","Broad forehead","Budd-Chiari syndrome",
"Cleft palate","Cleft soft palate","Congenital abnormal hair pattern",
"Congenital malformation of the great arteries","Coronal craniosynostosis","Craniosynostosis",
"Decreased head circumference","Developmental cataract","Developmental glaucoma",
"Erythroid hypoplasia","Fetal anomaly","Genetic disorder","Global developmental delay",
"Head tremor","High palate","\"High, narrow palate\"","Hydrops fetalis",
"Hypoplasia of teeth","Hypoplasia of the maxilla","Lambdoidal craniosynostosis","Microcephaly",
"Narrow palate","Neurodevelopmental abnormality","Neurodevelopmental delay",
"Nonimmune hydrops fetalis","Optic nerve hypoplasia","Oral cleft","Pain in head and neck region",
"Proportionate short stature","Pure red cell aplasia","Radial artery aplasia","Renal agenesis",
"Renal hypoplasia/aplasia","Sagittal craniosynostosis","Severe short stature","Short stature",
"Small forehead","Age","Test result","Sign or symptom","Disease","Sign or symptom",
"Population measurement","Self reported educational attainment","Parental longevity",
"Traffic air pollution measurement","Educational attainment","Hypospadias","Narrow mouth",
"Brachycephaly","Microcephaly","Turricephaly","Abnormality of the face",
"Abnormal mandible morphology","Retrognathia","Abnormality of the forehead","Pointed chin",
"Hypertelorism","Triangular face","Abnormality of the maxilla","Broad forehead","Long philtrum",
"Abnormal location of ears","Abnormal earlobe morphology","Low-set ears","Tooth malposition",
"Split hand","Triphalangeal thumb","Slender finger","Broad finger","Small for gestational age",
"Split foot","Metatarsus adductus","Underdeveloped supraorbital ridges","Crumpled ear",
"Duplication of thumb phalanx","Partial duplication of thumb phalanx",
"Partial duplication of the phalanx of hand","Duplication of phalanx of hallux",
"Abnormality of the phalanges of the toes","Midface retrusion","Short digit","Flat face",
"Spina bifida occulta", "Short palm", "Short 5th finger"
)
# Remove excluded rows
df <- df %>%
filter(!description %in% exclude)
# Get top 10 categories by absolute count
hpo_top_categories_abs <- df %>%
count(class, sort = TRUE) %>%
slice_max(n, n = 10) %>%
pull(class)
# Filter to top 10 categories
hpo_filtered_abs <- df %>%
filter(class %in% hpo_top_categories_abs)
# Count (class, ChemicalName)
hpo_stacked_data <- hpo_filtered_abs %>%
count(class, ChemicalName)
# Reorder categories by total count
hpo_category_order_abs <- hpo_stacked_data %>%
group_by(class) %>%
summarise(total = sum(n), .groups = "drop") %>%
arrange(desc(total)) %>%
pull(class)
# Factor with desired order
hpo_stacked_data$class <- factor(
hpo_stacked_data$class,
levels = hpo_category_order_abs
)
# Plot stacked bar chart
hpo_chemical_contributions_stacked_bar <- ggplot(hpo_stacked_data, aes(
x = n,
y = class,
fill = ChemicalName
)) +
geom_bar(stat = "identity") +
labs(
title = "Chemical Contributions in Top 10 HPO Categories",
x = "Number of Occurrences",
y = "class"
) +
scale_x_continuous(expand = c(0, 0)) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12)
) +
guides(fill = guide_legend(title = "Chemical Name"))
print(hpo_chemical_contributions_stacked_bar)
# Save plot
ggsave(
"HPO_analysis/chemical_contributions_stacked_bar.png",
plot = hpo_chemical_contributions_stacked_bar,
width = 10, height = 6, dpi = 300
)
# Top 10 categories by absolute count (reuse logic for consistency)
hpo_top_categories_rel <- df %>%
count(class, name = "total") %>%
slice_max(total, n = 10) %>%
pull(class)
# Filter to those categories
hpo_filtered_rel <- df %>%
filter(class %in% hpo_top_categories_rel)
# Count (class, ChemicalName) pairs
hpo_contributions_rel <- hpo_filtered_rel %>%
count(class, ChemicalName, name = "n")
# Normalize within each category
hpo_normalized_rel <- hpo_contributions_rel %>%
group_by(class) %>%
mutate(share = n / sum(n)) %>%
ungroup()
# Order categories by total occurrences (same order as absolute totals)
hpo_category_order_rel <- hpo_contributions_rel %>%
group_by(class) %>%
summarise(total = sum(n), .groups = "drop") %>%
arrange(desc(total)) %>%
pull(class)
hpo_normalized_rel$class <- factor(
hpo_normalized_rel$class,
levels = hpo_category_order_rel
)
# Plot normalized stacked bar (vertical)
hpo_rel_plot <- ggplot(hpo_normalized_rel, aes(x = class, y = share, fill = ChemicalName)) +
geom_col(width = 0.7) +
labs(
title = "Relative Chemical Contributions in Top 10 HPO Categories",
x = "class",
y = "Relative Share"
) +
scale_y_continuous(labels = percent_format(accuracy = 1)) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_text(size = 12)
) +
guides(fill = guide_legend(title = "Chemical Name"))
print(hpo_rel_plot)
# Save
ggsave("HPO_analysis/normalized_chemical_contributions.png",
plot = hpo_rel_plot, width = 12, height = 6, dpi = 300)
# Define HPO groups
blood_chemistry_biomarkers <- c(
"Protein measurement","Abnormal circulating metabolite concentration","Blood protein measurement",
"Hematological measurement","Lipid measurement","Lipid or lipoprotein measurement",
"Triglyceride measurement","Abnormal circulating lipid concentration","Abnormal enzyme/coenzyme activity",
"Lipoprotein measurement","Abnormal LDL cholesterol concentration",
"Abnormal circulating carboxylic acid concentration","Abnormal circulating cholesterol concentration",
"Abnormal circulating nitrogen compound concentration","Apolipoprotein A 1 measurement",
"Decreased circulating GABA concentration","Elevated sweat chloride","Liver enzyme measurement",
"Serum alanine aminotransferase measurement","Serum urea measurement",
"Abnormal blood cation concentration","Abnormal blood ion concentration",
"Abnormal blood potassium concentration","Abnormal circulating albumin concentration",
"Abnormal erythrocyte sedimentation rate","Abnormal glucose homeostasis","Cytokine measurement",
"Glucose measurement","Hypercholesterolemia","Hyperlipoproteinemia",
"Increased LDL cholesterol concentration","Low density lipoprotein cholesterol measurement",
"Metabolite measurement","Serum gamma-glutamyl transferase measurement","Transferrin saturation measurement",
"Abnormal blood monovalent inorganic cation concentration","Abnormal circulating bilirubin concentration",
"Abnormal circulating creatine kinase concentration","Abnormal circulating dicarboxylic acid concentration",
"Abnormal circulating ferritin concentration","Abnormal circulating non-proteinogenic amino acid concentration",
"Amino acid measurement","Antibody measurement","Apolipoprotein B measurement",
"Aspartate aminotransferase measurement",
"Aspartate aminotransferase to alanine aminotransferase ratio",
"Decreased plasma total carnitine","Diabetes mellitus biomarker","Elevated alpha-fetoprotein",
"Elevated circulating creatine kinase concentration","Endothelial growth factor measurement",
"Glucose intolerance","High density lipoprotein cholesterol measurement","Hyperammonemia",
"Hyperlipidemia","Hypoalbuminemia","Iron biomarker measurement",
"Leucine carboxyl methyltransferase 1 measurement","Liver disease biomarker",
"Serum albumin measurement","Serum iron measurement","Sphingolipid measurement",
"Total cholesterol measurement","Urate measurement","Increased circulating ferritin concentration",
"Elevated erythrocyte sedimentation rate"
)
erythrocytes_rbc <- c(
"Anemia","Abnormal erythrocyte morphology","Hemoglobin measurement","Anemia of inadequate production",
"Complete blood cell count","Reticulocyte count","Reticulocyte measurement","Macrocytic anemia",
"Mean corpuscular volume","Erythrocyte count","Erythrocyte indices","Erythrocyte measurement",
"Hypochromic anemia","Persistence of hemoglobin F","Red blood cell distribution width",
"Macrocytic dyserythropoietic anemia","Poikilocytosis","Reticulocytopenia","Methemoglobinemia",
"Polycythemia","Reticulocytosis","Abnormal number of erythroid precursors",
"Elevated red cell adenosine deaminase level","Extramedullary hematopoiesis","Heinz bodies",
"Abnormal hemoglobin","Normochromic anemia","Increased mean corpuscular volume",
"Mean corpuscular hemoglobin","Mean reticulocyte volume","Abnormal mean corpuscular volume",
"Red blood cell density measurement"
)
blood_total_count <- df %>%
filter(class == "Blood") %>%
nrow()
blood_in_all_pct <- blood_total_count / nrow(df) * 100
print(sprintf(
"%.1f%% of all HPO occurrences are classified as Blood (%d out of %d).",
blood_in_all_pct, blood_total_count, nrow(df)
))
biomarkers_count <- df %>%
filter(class == "Blood") %>%
filter(grepl(paste(blood_chemistry_biomarkers, collapse = "|"),
description, ignore.case = TRUE)) %>%
nrow()
biomarkers_pct <- biomarkers_count / blood_total_count * 100
print(sprintf(
"%.1f%% of Blood HPO occurrences are biomarkers (%d out of %d).",
biomarkers_pct, biomarkers_count, blood_total_count
))
rbc_count <- df %>%
filter(class == "Blood") %>%
filter(grepl(paste(erythrocytes_rbc, collapse = "|"),
description, ignore.case = TRUE)) %>%
nrow()
rbc_pct <- rbc_count / blood_total_count * 100
print(sprintf(
"%.1f%% of Blood HPO occurrences are erythrocyte/RBC-related (%d out of %d).",
rbc_pct, rbc_count, blood_total_count
))
musculoskeletal_total_count <- df %>%
filter(class == "Musculoskeletal") %>%
nrow()
musculoskeletal_in_all_pct <- musculoskeletal_total_count / nrow(df) * 100
print(sprintf(
"%.1f%% of all HPO occurrences are classified as Musculoskeletal (%d out of %d).",
musculoskeletal_in_all_pct, musculoskeletal_total_count, nrow(df)
))
cardiovascular_total_count <- df %>%
filter(class == "Cardiovascular") %>%
nrow()
cardiovascular_in_all_pct <- cardiovascular_total_count / nrow(df) * 100
print(sprintf(
"%.1f%% of all HPO occurrences are classified as Cardiovascular (%d out of %d).",
cardiovascular_in_all_pct, blood_total_count, nrow(df)
))
musculoskeletal_counts <- df %>%
filter(class == "Musculoskeletal") %>%
group_by(description) %>%      # change this to your column of interest
summarise(count = n()) %>%
arrange(desc(count))
